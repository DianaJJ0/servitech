<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <title>Agendar Asesoría | Servitech</title>
    <link rel="stylesheet" href="/assets/css/base.css">
    <link rel="stylesheet" href="/assets/css/componentes.css">
    <link rel="stylesheet" href="/assets/css/calendario.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>

<body>
    <%- include('componentes/header') %>
        <main class="container calendario-main">
            <section class="expert-profile">
                <div class="profile-card">
                    <div class="profile-avatar">
                        <% if (experto.avatarUrl) { %>
                            <img src="<%= experto.avatarUrl %>" alt="Foto de <%= experto.nombre %>">
                            <% } else { %>
                                <span class="avatar-iniciales">
                                    <%= (experto.nombre && experto.apellido) ? (experto.nombre[0] +
                                        experto.apellido[0]).toUpperCase() : (experto.nombre ?
                                        experto.nombre[0].toUpperCase() : 'E' ) %>
                                </span>
                                <% } %>
                    </div>
                    <div class="profile-info">
                        <h2>
                            <%= experto.nombre %>
                                <%= experto.apellido %>
                        </h2>
                        <p class="profile-especialidad"><i class="fas fa-award"></i>
                            <%= experto.infoExperto?.descripcion || 'Especialista Técnico' %>
                        </p>
                        <p class="profile-descripcion">
                            <%= experto.infoExperto?.descripcion || 'Experto en tecnología y asesorías personalizadas.'
                                %>
                        </p>
                        <div class="profile-contacto">
                            <i class="fas fa-envelope"></i>
                            <%= experto.email %>
                        </div>
                    </div>
                </div>
            </section>

            <section class="calendar-agenda">
                <h3>Agenda una asesoría</h3>
                <form id="formAgendarAsesoria" autocomplete="off">
                    <div class="calendar-container">
                        <div id="calendar"></div>
                    </div>
                    <div class="hour-selector">
                        <label for="hora">Hora disponible:</label>
                        <select id="hora" name="hora" required>
                            <option value="">Selecciona una hora</option>
                        </select>
                    </div>
                    <div id="errorCalendar" class="input-error"></div>
                    <button type="submit" class="btn btn-primary">Solicitar asesoría</button>
                </form>
                <div id="successMsg" class="success-msg"></div>
            </section>
        </main>
        <%- include('componentes/footer') %>
            <script>
                window.experto = <%= JSON.stringify(experto) %>;
                window.usuario = <%= JSON.stringify(usuario) %>;
                window.asesoriasExistentes = <%= JSON.stringify(asesoriasExistentes) %>;
            </script>
            <script src="/assets/js/calendario.js"></script>
</body>

</html>
